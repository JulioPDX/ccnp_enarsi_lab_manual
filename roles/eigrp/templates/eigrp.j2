{% for instance in eigrp.ipv4 -%}
router eigrp {{ instance.name }}
 address-family ipv4 unicast autonomous-system {{ instance.as }}
 {%- for interface in instance.interfaces %}
  af-interface {{ interface.name }}
  {%- if interface.split_horizon == False %}
   no split-horizon
  exit-af-interface
  {%- endif -%}
 {% endfor %}
  topology base
  exit-af-topology
  {% for network in instance.networks -%}
  network {{ network }}
  {%- endfor %}
  {%- if instance.router_id is defined %} 
  eigrp router-id {{ instance.router_id }}
  {%- endif %}
 exit-address-family
{% endfor %}
